---
title: Реализация отрисовщика
author: matthidinger
ms.author: mahiding
ms.date: 09/15/2017
ms.topic: article
ms.openlocfilehash: b39493f82f3378e5a554abc6df890d6821869671
ms.sourcegitcommit: e002a988c570072d5bc24a1242eaaac0c9ce90df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/14/2019
ms.locfileid: "67138027"
---
# <a name="adaptive-card-renderer-specification"></a>Спецификация отрисовщика адаптивных карточек

Следующая спецификация описывает, как реализовать отрисовщик адаптивных карточек на любой платформе пользовательского интерфейса.

> [!IMPORTANT]
> 
> Содержимое статьи еще не завершено. Проверьте его в скором времени.

## <a name="sdk-versioning"></a>Управление версиями пакетов SDK

1. Основной и дополнительный номера версий пакета SDK **должны** соответствовать номеру версии `schema`. 
1. Для обновлений отрисовщика, которые не включают в себя изменения схемы, **обязательно** следует выполнить установку исправлений или сборку.

## <a name="parsing-json"></a>Анализ JSON

### <a name="error-conditions"></a>Условия ошибок
1. Анализатор **должен** проверять допустимость содержимого JSON.
1. Анализатор **должен** проверять схему (обязательные свойства и т. д.).
1. Сведения об указанных выше ошибках **должны** передаваться ведущему приложению (исключение или аналог).

### <a name="unknown-types"></a>Неизвестные типы
1. Если обнаружены неизвестные "типы", они **должны быть удалены** из полученного результата.
1. Любые изменения полезных данных (как показано выше) **должны** быть переданы в виде предупреждений в ведущее приложение.

### <a name="unknown-properties"></a>Неизвестные свойства
1. Анализатор **должен** добавить **дополнительные** свойства элементов.

### <a name="additional-considerations"></a>Дополнительные рекомендации
1. Свойство `speak` может содержать разметку SSML и **должно** возвращаться в ведущее приложение, как указано.

## <a name="parsing-host-config"></a>Анализ HostConfig
1. Список действий

## <a name="versioning"></a>Управление версиями

1. Отрисовщик **должен** реализовывать определенную версию схемы. 
1. Конструктор `AdaptiveCard` **должен** присвоить свойству `version` значение по умолчанию, основанное на текущей версии схемы. 
1. Если отрисовщик обнаруживает свойство `version` в `AdaptiveCard`, значение которого больше номера текущей поддерживаемой версии, то он **должен** возвращать `fallbackText`.

## <a name="rendering"></a>Отрисовка

Объект `AdaptiveCard` состоит из элементов `body` и `actions`. Элемент `body` представляет собой коллекцию элементов `CardElement`, которые отрисовщик будет перечислять и отображать по порядку. 

1. Каждый элемент **должен** быть растянут до ширины его родительского элемента (вспомните о `display: block` в HTML).
1. Отрисовщик **должен** игнорировать неизвестные типы элементов и продолжить отрисовку оставшейся части полезных данных.

### <a name="spacing-and-separators"></a>Интервалы и разделители

1. Свойство `spacing` каждого элемента влияет на расстояние между **текущим** элементом и элементом, находящимся **перед** ним.
1. Интервал должен применяться **только** в том случае, если перед элементом есть другой элемент. (Например, он не должен применяться к первому элементу в массиве.)
1. Отрисовщик **должен** определить, сколько нужно использовать пространства, с помощью интервала в `hostConfig`, указанного для значения перечисления, примененного к текущему элементу.
1. Если для элемента задан параметр `separator` со значением `true`, то между текущим и предыдущим элементами **должна** быть нарисована видимая линия.
1. Разделительная линия **должна** быть нарисована с помощью `container.style.default.foregroundColor`.
1. Разделитель должен быть нарисован **только** в том случае, если элемент **не является** первым в массиве.

### <a name="columns"></a>Столбцы

1. Параметры `Column` и `width` **должны** интерпретироваться с учетом ключевых слов auto, stretch или с помощью взвешенного соотношения.

### <a name="textblock"></a>TextBlock

1. Элемент TextBlock **должен** занимать одну строку, если только свойство `wrap` не имеет значение `true`. 
1. Текстовый блок **должен** обрезать любой лишний текст с помощью многоточия (…).

#### <a name="markdown"></a>Markdown

1. Адаптивные карточки поддерживают часть элементов Markdown, которые **должны** поддерживаться в объектах `TextBlock`. 
1. Ознакомьтесь с [полными требованиями к Markdown](../authoring-cards/text-features.md).

#### <a name="formatting-functions"></a>Функции форматирования

1. `TextBlock` допускает использование [функций форматирования даты и времени](../authoring-cards/text-features.md), которые **должны** поддерживаться каждым отрисовщиком.
1. **Все сообщения об ошибке должны** отображать необработанную строку в карточке. Понятное сообщение о попытке отображать не нужно. (Это нужно для того, чтобы разработчик сразу узнал о проблеме.)

1. TODO: добавьте регулярное выражение.

### <a name="images"></a>образы,

1. Отрисовщик **должен** давать ведущим приложениям возможность определить, когда все изображения HTTP скачаны и карточка полностью отображена.
1. Отрисовщик **должен** проверять параметр `maxImageSize` HostConfig при скачивании изображений HTTP.
1. Отрисовщик **должен** поддерживать `.png` и `.jpeg`.
1. Отрисовщик **должен** поддерживать изображения с расширением `.gif`.

### <a name="host-config"></a>Конфигурация узла

* TODO: Какими должны быть значения по умолчанию? Должны ли использоваться совместно? Следует ли внедрить в двоичные файлы общий файл hostConfig.JSON?
* TODO: Требуется ли управление версиями HostConfig и для анализа?

[`HostConfig`](host-config.md) — это общий объект конфигурации, указывающий, как отрисовщик адаптивных карточек создает пользовательский интерфейс.  

Это позволяет отрисовщикам на разных платформах и устройствах использовать свойства, которые независимы от платформы. Кроме того, это позволяет создавать наборы инструментов, которые дают представление о внешнем виде и функциях карточки в конкретной среде.

1. Отрисовщики **должны** предоставлять параметр **HostConfig** ведущим приложениям.
1. Все элементы **должны** быть стилизованы согласно соответствующим параметрам HostConfig.

### <a name="native-platform-styling"></a>Стиль собственной платформы

1. Каждый тип элемента **должен** привязывать стиль собственной платформы к созданному элементу пользовательского интерфейса. Например, в HTML мы добавили класс CSS к типам элементов, а в XAML мы присваиваем конкретный стиль.

## <a name="extensibility"></a>Расширяемость 

1. Отрисовщик **должен** позволять ведущим приложениям переопределять отрисовщики элементов по умолчанию. Например, заменить отрисовку `TextBlock` собственной логикой.
1. Отрисовщик **должен** позволять ведущим приложениям регистрировать пользовательские типы элементов. Например, добавить поддержку пользовательского элемента `Rating`.
1. Отрисовщик **должен** позволять ведущим приложениям удалять поддержку элемента по умолчанию. Например, удалить элемент `Action.Submit`, если его поддержка не нужна.

## <a name="actions"></a>Действия

1. Если параметр `supportsInteractivity` HostConfig имеет значение `false`, то отрисовщик **не должен** отображать какие-либо действия.
1. Свойство `actions` **должно** быть отображено в виде кнопок на панели действий, как правило, в нижней части карточки. 
1. При нажатии кнопка **должна** позволить ведущему приложению обработать событие. 
1. Событие **должно** передавать все связанные свойства с действием.
1. Событие **должно** передавать объект `AdaptiveCard`, который был выполнен.

Действие | Поведение
--- | ---
**Action.OpenUrl** | Открытие внешнего URL-адреса для просмотра.
**Action.ShowCard** | Запрашивает вложенную карточку для отображения пользователю.
**Action.Submit** | Запрашивает сбор данных от всех элементов в один объект и его отправку способом, определяемым ведущим приложением.

### <a name="actionopenurl"></a>Action.OpenUrl
1. Действие `Action.OpenUrl` **должно** открывать URL-адрес с помощью механизма собственной платформы.
1. Если это невозможно, оно **должно** породить событие в ведущем приложении для обработки открытия этого URL-адреса. Это событие **должно** позволить ведущему приложению переопределить поведение по умолчанию. Например, разрешить ему открыть этот URL-адрес в собственном приложении.

### <a name="actionshowcard"></a>Action.ShowCard

1. Поддержка `Action.ShowCard` **должна** быть обеспечена каким-либо из способов, в зависимости от параметра HostConfig. Существуют два режима: встроенные карточки и всплывающие окна. Встроенные карточки **должны** автоматически переключать видимость карточки. В режиме всплывающего окна событие **должно** быть передано в ведущее приложение, чтобы оно отобразило карточку каким-либо способом.

### <a name="actionsubmit"></a>Action.Submit

Действие отправки выполняется, как и отправка данных в форме HTML, за исключением того, что если HTML обычно запускает HTTP-запрос POST, то адаптивные карточки в определении смысла отправки полагаются на само ведущее приложение. 

1. В этом случае **должно** вызываться событие, когда пользователь касается вызванного действия.  
1. Свойство `data` **должно** быть включено в полезные данные обратного вызова.
1. Для `Action.Submit` отрисовщик **должен** собрать все входные данные в карточке и получить их значения. 

### <a name="selectaction"></a>selectAction

1. Если параметр `supportedInteractivity` HostConfig имеет значение `false`, то `selectAction` **не должно** отображаться как объект, доступный для касания.
1. Элементы `Image`, `ColumnSet` и `Column` предлагают свойство `selectAction`, которое **должно** выполняться, когда пользователь вызывает его, например, коснувшись элемента.

## <a name="inputs"></a>Ввод данных

1. Если параметр `supportsInteractivity` HostConfig имеет значение `false`, то отрисовщик **не должен** отображать какие-либо управляющие элементы ввода.
2. Управляющие элементы ввода **должны** отображаться с максимально допустимой точностью. Например, `Input.Date` в идеале представит пользователю управляющий элемент выбора даты, но если это невозможно в стеке пользовательского интерфейса, то отрисовщик **должен** вернуться к отображению стандартного текстового поля.
3. Отрисовщик **должен** отображать `placeholderText`, если это возможно.
4. В отрисовщике **не обязательно** реализовывать проверку входных данных. Пользователи адаптивных карточек должны запланировать проверку всех полученных данных на своей стороне.
5. Привязка входного значения **должна** быть правильно экранирована.

6. Объект **должен** быть возвращен в ведущее приложение следующим образом.

   Мы не обещаем проверку входных данных в адаптивных карточках, поэтому именно принимающая сторона должна соответствующим образом проанализировать ответ. Например, Input.Number может вернуть "hello", и они должны быть готовы к этому.


## <a name="events"></a>Мероприятия

1. Отрисовщик **должен** запускать событие при изменении видимости элемента, позволяя ведущему приложению прокрутить карточку до нужного места.
